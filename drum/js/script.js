$(function(){crashCymbolAll=$('#Crash');crashCymbol=$('#Crash-Cymbol');crashAudio=$('#Crash-Audio');var crashtl=new TimelineMax({paused:true});crashtl.to(crashCymbol,0.1,{rotation:8,transformOrigin:"50% 50%"}).to(crashCymbol,1.5,{rotation:0,transformOrigin:"50% 50%",ease:Elastic.easeOut.config(2.5,0.3)});window.crash=function(){crashtl.restart();crashtl.play();var crashAudioEl=crashAudio.get(0);crashAudioEl.currentTime=0;crashAudioEl.play();}
var clickTouchCrashDone=false;crashCymbolAll.on("touchstart click",function(){if(!clickTouchCrashDone){clickTouchCrashDone=true;setTimeout(function(){clickTouchCrashDone=false;},100);crash();return false;}});rightTomDrumAll=$('#Tom-Right-All');rightTomDrum=$('#Tom-Right-Drum');smallTomAudio=$('#Small-Rack-Tom-Audio');var rightTomtl=new TimelineMax({paused:true});rightTomtl.to(rightTomDrum,0.1,{scaleX:1.04,transformOrigin:"50% 50%",ease:Expo.easeOut}).to(rightTomDrum,0.1,{scaleY:0.95,transformOrigin:"50% 50%",ease:Expo.easeOut},'0').to(rightTomDrumAll,0.1,{rotation:2.5,transformOrigin:"0 50%",ease:Elastic.easeOut},'0').to(rightTomDrum,0.4,{scale:1,transformOrigin:"50% 50%",ease:Elastic.easeOut}).to(rightTomDrumAll,0.6,{rotation:0,transformOrigin:"0 50%",ease:Elastic.easeOut},'-=0.4');window.rightTom=function(){rightTomtl.restart();rightTomtl.play();var smallTomAudioEl=smallTomAudio.get(0);smallTomAudioEl.currentTime=0;smallTomAudioEl.play();}
var clickTouchRTDrumDone=false;rightTomDrumAll.on("touchstart click",function(){if(!clickTouchRTDrumDone){clickTouchRTDrumDone=true;setTimeout(function(){clickTouchRTDrumDone=false;},100);rightTom();return false;}});leftTomDrumAll=$('#Tom-Left-All');leftTomDrum=$('#Tom-Left-Drum');bigTomAudio=$('#Big-Rack-Tom-Audio');var leftTomtl=new TimelineMax({paused:true});leftTomtl.to(leftTomDrum,0.1,{scaleX:1.04,transformOrigin:"50% 50%",ease:Expo.easeOut}).to(leftTomDrum,0.1,{scaleY:0.95,transformOrigin:"50% 50%",ease:Expo.easeOut},'0').to(leftTomDrumAll,0.1,{rotation:-2.5,transformOrigin:"100% 50%",ease:Elastic.easeOut},'0').to(leftTomDrum,0.4,{scale:1,transformOrigin:"50% 50%",ease:Elastic.easeOut}).to(leftTomDrumAll,0.6,{rotation:0,transformOrigin:"100% 50%",ease:Elastic.easeOut},'-=0.4');window.leftTom=function(){leftTomtl.restart();leftTomtl.play();var bigTomAudioEl=bigTomAudio.get(0);bigTomAudioEl.currentTime=0;bigTomAudioEl.play();}
var clickTouchLTDrumDone=false;leftTomDrumAll.on("touchstart click",function(){if(!clickTouchLTDrumDone){clickTouchLTDrumDone=true;setTimeout(function(){clickTouchLTDrumDone=false;},100);leftTom();return false;}});floorTomDrumAll=$('#Floor-Tom');floorTomAudio=$('#Floor-Tom-Audio');var floorTomtl=new TimelineMax({paused:true});floorTomtl.to(floorTomDrumAll,0.1,{scaleX:1.02,transformOrigin:"50% 50%",ease:Expo.easeOut}).to(floorTomDrumAll,0.1,{scaleY:0.95,transformOrigin:"50% 100%",ease:Expo.easeOut},'0').to(floorTomDrumAll,0.4,{scale:1,transformOrigin:"50% 100%",ease:Elastic.easeOut});window.floorTom=function(){floorTomtl.restart();floorTomtl.play();var floorTomAudioEl=floorTomAudio.get(0);floorTomAudioEl.currentTime=0;floorTomAudioEl.play();}
var clickTouchTDrumDone=false;floorTomDrumAll.on("touchstart click",function(){if(!clickTouchTDrumDone){clickTouchTDrumDone=true;setTimeout(function(){clickTouchTDrumDone=false;},100);floorTom();return false;}});snareDrumAll=$('#Snare');snareDrum=$('#Snare-Drum');snareAudio=$('#Snare-Audio');var snaretl=new TimelineMax({paused:true});snaretl.to(snareDrum,0.1,{scaleX:1.04,transformOrigin:"50% 50%",ease:Expo.easeOut}).to(snareDrum,0.1,{scaleY:0.9,transformOrigin:"50% 100%",ease:Expo.easeOut},'0').to(snareDrum,0.4,{scale:1,transformOrigin:"50% 100%",ease:Elastic.easeOut});window.snare=function(){snaretl.restart();snaretl.play();var snareAudioEl=snareAudio.get(0);snareAudioEl.currentTime=0;snareAudioEl.play();}
var clickTouchSnareDone=false;snareDrumAll.on("touchstart click",function(){if(!clickTouchSnareDone){clickTouchSnareDone=true;setTimeout(function(){clickTouchSnareDone=false;},100);snare();return false;}});kickDrumAll=$('#Kick');kickAudio=$('#Kick-Audio');var kicktl=new TimelineMax({paused:true});kicktl.to(kickDrumAll,0.1,{scale:1.02,transformOrigin:"50% 100%",ease:Expo.easeOut}).to(kickDrumAll,0.4,{scale:1,transformOrigin:"50% 100%",ease:Elastic.easeOut});window.kick=function(){kicktl.restart();kicktl.play();var kickAudioEl=kickAudio.get(0);kickAudioEl.currentTime=0;kickAudioEl.play();}
var clickTouchKickDone=false;kickDrumAll.on("touchstart click",function(){if(!clickTouchKickDone){clickTouchKickDone=true;setTimeout(function(){clickTouchKickDone=false;},100);kick();return false;}});hiHatAll=$('#Hi-Hat');hiHatTop=$('#Hi-Hat-Top');hiHatBottom=$('#Hi-Hat-Bottom');hiHatClosedAudio=$('#Hi-Hat-Closed-Audio');var hiHattl=new TimelineMax({paused:true});hiHattl.to([hiHatTop,hiHatBottom],0.1,{rotation:-4,transformOrigin:"50% 50%"}).to([hiHatTop,hiHatBottom],0.6,{rotation:0,transformOrigin:"50% 50%",ease:Elastic.easeOut.config(1.5,0.2)});window.hiHat=function(){hiHattl.restart();hiHattl.play();var hiHatClosedAudioEl=hiHatClosedAudio.get(0);hiHatClosedAudioEl.currentTime=0;hiHatClosedAudioEl.play();}
var clickTouchHitHatDone=false;hiHatAll.on("touchstart click",function(){if(!clickTouchHitHatDone){clickTouchHitHatDone=true;setTimeout(function(){clickTouchHitHatDone=false;},100);hiHat();return false;}});allKeys=$('#All-Keys');function animateKey(key){keytl=new TimelineMax({paused:true});keytl.to(key,0.1,{scale:1.1,transformOrigin:"50% 50%",ease:Expo.easeOut}).to(key,0.4,{scale:1,transformOrigin:"50% 50%",ease:Elastic.easeOut});keytl.restart();keytl.play();}
$('#keys-btn').click(function(){allKeys.fadeToggle();});document.onkeydown=function(e){thisKeyID='Key-'+e.keyCode;thisKey=$('#'+thisKeyID);switch(e.keyCode){case 74:hiHat();animateKey(thisKey);break;case 72:snare();animateKey(thisKey);break;case 66:kick();animateKey(thisKey);break;case 71:floorTom();animateKey(thisKey);break;case 70:crash();animateKey(thisKey);break;case 84:leftTom();animateKey(thisKey);break;case 89:rightTom();animateKey(thisKey);break;}};sequencerVisible=false;$('#sequencer-visible-btn').click(function(){$("#container-sequencer").toggleClass("collapse");if(sequencerVisible===false){sequencerVisible=true;}else{sequencerVisible=false;}
$("#container-drums").toggleClass("screen-sm-hidden");});rows=$('.row');rowLength=rows.first().children().length;labels=$('label');beat=1;function sequencer(){labels.removeClass('active');$(rows).each(function(){current=$(this).children().eq(beat);current.addClass('active');if(current.find('input').is(":checked")){targetDrum=(current.parent().attr('data-target-drum'));fn=window[targetDrum];if(typeof fn==="function"){fn();}}});if(beat<(rowLength-1)){++beat;}else{beat=1;}}
sequencerOn=false;$('#sequencer-active-btn').click(function(){$(this).find('i').toggleClass('fa-pause');if(sequencerOn===false){intervalId=window.setInterval(sequencer,interval);sequencerOn=true;}else{window.clearInterval(intervalId);sequencerOn=false;}});bpm=150;interval=60000/bpm;function setTempo(){window.clearInterval(intervalId);intervalId=window.setInterval(sequencer,interval);}
$('#bpm-increase-btn').click(function(){if(bpm<300){bpm=parseInt($('#bpm-indicator').val());bpm+=10;interval=60000/bpm;$('#bpm-indicator').val(bpm);if(sequencerOn===true){setTempo();}}});$('#bpm-decrease-btn').click(function(){if(bpm>100){bpm=parseInt($('#bpm-indicator').val());bpm-=10;interval=60000/bpm;$('#bpm-indicator').val(bpm);if(sequencerOn===true){setTempo();}}});$('input').click(function(){if(sequencerOn===false){if($(this).is(":checked")){targetDrum=$(this).parents(".row").attr('data-target-drum');fn=window[targetDrum];if(typeof fn==="function"){fn();}}}});$('#sequencer-visible-btn').one('click',function(){$("audio").each(function(i){this.play();this.pause();});});});